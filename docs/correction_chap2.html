<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Camelia Goga" />

<meta name="date" content="2026-01-15" />

<title>Solutions exercices chapitre 2</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Techniques de sondage avec R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">I. Présentation</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    II. Code R
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="code_r_chap1.html">a) Chapitre 1</a>
    </li>
    <li>
      <a href="code_r_chap2.html">b) Chapitre 2</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    III. Correction Exercices
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="correction_chap1.html">a) Chapitre 1</a>
    </li>
    <li>
      <a href="correction_chap2.html">b) Chapitre 2</a>
    </li>
    <li>
      <a href="correction_chap3.html">c) Chapitre 3</a>
    </li>
    <li>
      <a href="correction_chap4.html">d) Chapitre 4</a>
    </li>
    <li>
      <a href="correction_chap5_6.html">e) Chapitres 5 et 6</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Solutions exercices chapitre 2</h1>
<h4 class="author">Camelia Goga</h4>
<h4 class="date">2026-01-15</h4>

</div>


<div id="solution-exercice-2.1" class="section level2">
<h2>Solution exercice 2.1</h2>
<p>non; oui; oui; non</p>
</div>
<div id="solution-exercice-2.2" class="section level2">
<h2>Solution exercice 2.2</h2>
<p>La probabilité d’inclusion <span class="math inline">\(\pi_k\)</span>
se calcule selon la définition donnée dans le chapitre 1; on a <span
class="math display">\[
\pi_k=\sum_{s\in \mathcal S, k\in s}p(s)=\sum_{|s|=n, k\in
s}p(s)=\frac{\binom{N-1}{n-1}}{\binom{N}{n}}=\frac{n}{N}, \quad k\in U,
\]</span> car <span class="math inline">\(p(s)=1/\binom{N}{n}\)</span>
pour tout échantillon <span class="math inline">\(s\)</span> de taille
<span class="math inline">\(n\)</span> et zéro sinon et il y a <span
class="math inline">\(\binom{N-1}{n-1}\)</span> parties de <span
class="math inline">\(n\)</span> individus choisis sans remise parmi les
<span class="math inline">\(N\)</span> individus de la population, qui
contiennent l’individu <span class="math inline">\(k.\)</span> Pour
calculer <span class="math inline">\(\pi_{kl}\)</span> on procède de la
même façon: <span class="math display">\[
\pi_{kl}=\sum_{s\in \mathcal S, k, l\in s}p(s)=\sum_{|s|=n, k,l\in
s}p(s)=\frac{\binom{N-2}{n-2}}{\binom{N}{n}}=\frac{n(n-1)}{N(N-1)},
\quad k\neq l\in U.
\]</span></p>
</div>
<div id="solution-exercice-2.3" class="section level2">
<h2>Solution exercice 2.3</h2>
<p>Considérons le schéma de tirage sans remise de <span
class="math inline">\(n\)</span> billes à partir d’une urne de <span
class="math inline">\(N\)</span> billes: la probabilité de sélectionner
la première bille est <span class="math inline">\(1/N,\)</span> la
deuxième bille <span class="math inline">\(1/(N-1)\)</span> et la <span
class="math inline">\(n\)</span>-ème bille <span
class="math inline">\(1/(N-n+1),\)</span> donc la probabilité de
sélectionner une configuration ordonnée (selon l’ordre de tirage) de
<span class="math inline">\(n\)</span> billes est de <span
class="math display">\[
\frac{1}{N\times (N-1)\times\ldots\times(N-n+1)}=\frac{(N-n)!}{N!}\cdot
\]</span> Un certain ensemble <span class="math inline">\(s\)</span> de
<span class="math inline">\(n\)</span> individus distincts peut être
obtenu comme le résultat de <span class="math inline">\(n!\)</span>
configurations ordonnées et de même probabilité, donc la probabilité
d’obtenir <span class="math inline">\(s\)</span> de taille <span
class="math inline">\(n\)</span> est <span class="math display">\[
p(s)=n!\frac{(N-n)!}{N!}=\frac{1}{\binom{N}{n}}.
\]</span></p>
</div>
<div id="solution-exercice-2.4" class="section level2">
<h2>Solution exercice 2.4</h2>
<p>Pour calculer la variance de <span
class="math inline">\(\hat{t}_{y\rm{HT}}\)</span> sous le plan SI, on
utilise les termes de covariance <span
class="math inline">\(\Delta_{kl}\)</span> calculés dans l’exercice 2.2:
<span class="math display">\[\begin{eqnarray*}
  \mathop{\mathrm{V}}_{\rm{SI}}(\hat{t}_{y\rm{HT}}) &amp;=&amp;
\sum_{k\in U}\Delta_{kk}\frac{y^2_k}{\pi^2_k}+\sum_{k\in U}\sum_{l\in U,
l\neq k}\Delta_{kl}\frac{y_k}{\pi_k}\frac{y_l}{\pi_l}\\
  &amp;=&amp; \frac{n(N-n)}{N^2}\frac{N^2}{n^2}\sum_{k\in
U}y_k^2-\frac{n(N-n)}{N^2(N-1)}\frac{N^2}{n^2}\sum_{k\in U}\sum_{l\in U,
l\neq k}y_ky_l\\
  &amp;= &amp; \frac{N-n}{n(N-1)}\left[(N-1)\sum_{k\in
U}y_k^2-\sum_{k\in U}\sum_{l\in U, l\neq k}y_ky_l\right]\\
  &amp;=&amp; \frac{N-n}{n(N-1)}\left[N\sum_{k\in
U}y_k^2-\left(\sum_{k\in
U}y_k\right)^2\right]=\frac{N^2(1-f)}{n(N-1)}\left(\sum_{k\in
U}y_k^2-N\bar{y}^2_U\right)\\
  &amp;=&amp;\frac{N^2(1-f)}{n}S^2_{yU}.
\end{eqnarray*}\]</span> L’estimateur de la variance est donné par:
<span class="math display">\[\begin{eqnarray*}
  \hat{\mathop{\mathrm{V}}}_{\rm{SI}}(\hat{t}_{y\rm{HT}})&amp;=&amp;
\sum_{k\in s}\frac{\Delta_{kk}}{\pi_k}\frac{y^2_k}{\pi^2_k}+\sum_{k\in
s}\sum_{l\in s, l\neq
k}\frac{\Delta_{kl}}{\pi_{kl}}\frac{y_k}{\pi_k}\frac{y_l}{\pi_l}\\
  &amp;=&amp; \frac{n(N-n)}{N^2}\frac{N^3}{n^3}\sum_{k\in
s}y_k^2-\frac{n(N-n)}{N^2(N-1)}\frac{N(N-1)}{n(n-1)}\frac{N^2}{n^2}\sum_{k\in
s}\sum_{l\in s, l\neq k}y_ky_l\\
  &amp;=&amp; \frac{N(N-n)}{n^2(n-1)}\left[(n-1)\sum_{k\in
s}y_k^2-\sum_{k\in s}\sum_{l\in s, l\neq k}y_ky_l\right]\\
  &amp;=&amp; \frac{N(N-n)}{n^2(n-1)}\left[n\sum_{k\in
s}y_k^2-\left(\sum_{k\in
s}y_k\right)^2\right]=\frac{N(N-n)}{n(n-1)}\left(\sum_{k\in
s}y_k^2-n\bar{y}^2_s\right)^2\\
  &amp;=&amp; \frac{N^2(1-f)}{n}S^2_{ys}.
\end{eqnarray*}\]</span></p>
</div>
<div id="solution-exercice-2.5" class="section level2">
<h2>Solution exercice 2.5</h2>
<p>Le plan SI est un plan de taille fixe <span
class="math inline">\(n,\)</span> donc la variance de l’estimateur de
Horvitz-Thompson s’écrit sous la forme de la variance de
Yates-Grundy-Sen. On peut vérifier directement que les deux formules
coïncident, comme détaillé ci-dessous en partant de la formule de
Yates-Grundy-Sen: <span class="math display">\[\begin{eqnarray*}
    \mathop{\mathrm{V}}_{\rm{YGS}}(\hat{t}_{y\rm{HT}})&amp;=&amp;-\frac{1}{2}\sum_{k\in
U}\sum_{l\in
U}\Delta_{kl}\left(\frac{y_k}{\pi_k}-\frac{y_l}{\pi_l}\right)^2=-\frac{1}{2}\sum_{k\in
U}\sum_{l\neq k\in
U}\Delta_{kl}\left(\frac{y_k}{\pi_k}-\frac{y_l}{\pi_l}\right)^2\\
    &amp;=&amp;\frac{1}{2}\frac{n(N-n)}{N^2(N-1)}\frac{N^2}{n^2}\sum_{k\in
U}\sum_{l\neq k\in U}(y_k-y_l)^2\\
    &amp;=&amp; \frac{1}{2}\frac{N-n}{n(N-1)}\sum_{k\in U}\sum_{l\in
U}(y_k-\bar{y}_U+\bar{y}_U-y_l)^2\\
    &amp;=&amp; \frac{1}{2}\frac{N-n}{n(N-1)}\left[2\sum_{k\in
U}\sum_{l\in U}(y_k-\bar{y}_U)^2-2\sum_{k\in U}\sum_{l\in
U}(y_k-\bar{y}_U)(y_l-\bar{y}_U)\right]\\
    &amp;=&amp; \frac{N(N-n)}{n(N-1)}\sum_{k\in
U}(y_k-\bar{y}_U)^2=N^2\frac{(1-f)}{n}S^2_{yU},
\end{eqnarray*}\]</span> qui est la variance de l’estimateur de
Horvitz-Thompson pour un plan SI. Considérons maintenant l’estimateur de
la variance de type Yates-Grundy-Sen et montrons qu’il est égal à
l’estimateur de la variance de type Horvitz-Thompson: <span
class="math display">\[\begin{eqnarray*}
  \hat{\mathop{\mathrm{V}}}_{\rm{YGS}}(\hat{t}_{y\rm{HT}})&amp;=&amp;-\frac{1}{2}\sum_{k\in
s}\sum_{l\in
s}\frac{\Delta_{kl}}{\pi_{kl}}\left(\frac{y_k}{\pi_k}-\frac{y_l}{\pi_l}\right)^2\\
  &amp;=&amp;
\frac{1}{2}\frac{n(N-n)}{N^2(N-1)}\frac{N(N-1)}{n(n-1)}\frac{N^2}{n^2}\sum_{k\in
U}\sum_{l\neq k\in s}(y_k-y_l)^2\\
  &amp;=&amp; \frac{1}{2}\frac{N(N-n)}{n^2(n-1)}2n\sum_{k\in
s}(y_k-\bar{y}_s)^2=N^2\frac{1-f}{n}S^2_{ys},
\end{eqnarray*}\]</span> qui est l’estimateur de la variance de type
Horvitz-Thompson pour un plan SI.</p>
</div>
<div id="solution-exercice-2.6" class="section level2">
<h2>Solution exercice 2.6</h2>
<ol style="list-style-type: decimal">
<li>On écrit la taille de la population comme un total sur la population
<span class="math inline">\(U:\)</span> <span class="math display">\[
N=\sum_{k\in U}1,
\]</span> donc, l’estimateur de Horvitz-Thompson de <span
class="math inline">\(N\)</span> est égal à <span
class="math display">\[
\hat{N}=\sum_{k\in s}\frac{1}{\pi_k}\cdot
\]</span> Sa variance est donnée par <span class="math display">\[
\mathop{\mathrm{V}}(\hat N)=\sum_{k\in U}\sum_{l\in
U}\Delta_{kl}\frac{1}{\pi_k}\frac{1}{\pi_l
}\cdot
\]</span></li>
<li>(a). Avec un plan SI, l’estimateur <span class="math inline">\(\hat
N\)</span> devient: <span class="math display">\[
\hat{N}=\sum_{k\in s}\frac{N}{n}=N,
\]</span> de variance <span class="math display">\[
\mathop{\mathrm{V}}_{\rm{SI}}(\hat N)=N^2\frac{1-f}{n}S^2_{1U}=0
\]</span> car <span class="math inline">\(S^2_{1U}=\sum_{k\in
U}(1-1)^2/N=0.\)</span> On pouvait déduire directement que <span
class="math inline">\(\mathop{\mathrm{V}}_{\rm{SI}}(\hat N)=0\)</span>
car l’estimateur <span class="math inline">\(\hat N=N,\)</span> est
fixe, non aléatoire par rapport au plan de sondage.</li>
</ol>
<p>(b). Avec un plan BE(<span class="math inline">\(\pi\)</span>) et
<span class="math inline">\(\pi=n/N:\)</span> <span
class="math display">\[
\hat N=\sum_{k\in s}\frac{N}{n}=N\frac{n_s}{n},
\]</span> où <span class="math inline">\(n_s\)</span> est la taille de
l’échantillon de Bernoulli. La variance de <span
class="math inline">\(\hat N\)</span> dans le cas d’un plan BE est égale
à: <span class="math display">\[
\mathop{\mathrm{V}}_{\rm{BE}}(\hat
N)=\left(\frac{1}{\pi}-1\right)\sum_{k\in
U}1=\left(\frac{N}{n}-1\right)N=\frac{N^2}{n}\left(1-\frac{n}{N}\right).
\]</span> La variance peut être obtenue directement: <span
class="math display">\[
\mathop{\mathrm{V}}_{\rm{BE}}(\hat
N)=\frac{N^2}{n^2}\mathop{\mathrm{V}}(n_s)=\frac{N^2}{n^2}N\frac{n}{N}\left(1-\frac{n}{N}\right)=\frac{N^2}{n}(1-\frac{n}{N})
\]</span> car la taille <span class="math inline">\(n_s\)</span> suit
une loi de Bernoulli de paramètres <span
class="math inline">\(N\)</span> et <span
class="math inline">\(\pi=n/N.\)</span></p>
<p>Dans le cas d’un plan SI, la taille <span
class="math inline">\(N\)</span> est estimée parfaitement, sans erreur
d’échantillonnage, par l’estimateur de Horvitz-Thompson <span
class="math inline">\(\hat N\)</span> et la variance de l’estimateur
<span class="math inline">\(\hat N\)</span> est nulle. Dans le cas du
plan BE<span class="math inline">\((n/N),\)</span> l’estimateur <span
class="math inline">\(\hat N\)</span> est lié à la taille <span
class="math inline">\(n_s\)</span> de l’échantillon et sa variance
reflète la variabilité de la taille de l’échantillon.</p>
</div>
<div id="solution-exercice-2.7" class="section level2">
<h2>Solution exercice 2.7</h2>
<p>La variable <span class="math inline">\(y\)</span> est dichotomique:
<span class="math inline">\(y_k=1\)</span> si l’individu <span
class="math inline">\(k\)</span> a la propriété A et zéro sinon. On a
<span class="math inline">\(P=\sum_{k\in U}y_k/N=\bar{y}_U.\)</span> La
variance corrigée empirique de <span class="math inline">\(y\)</span>
calculée sur la population <span class="math inline">\(U\)</span> est
donnée par: <span class="math display">\[\begin{eqnarray*}
S^2_{yU}=\frac{1}{N-1}\sum_{k\in
U}(y_k-\bar{y}_U)^2=\frac{1}{N-1}\left(\sum_{k\in
U}y_k^2-N\bar{y}^2_U\right)&amp;=&amp;\frac{1}{N-1}\left(NP-NP^2\right)\\
&amp;=&amp; \frac{N}{N-1}P(1-P),
\end{eqnarray*}\]</span> car <span
class="math inline">\(y_k^2=y_k\)</span> pour tout <span
class="math inline">\(k\in U\)</span> dû au fait que <span
class="math inline">\(y\)</span> est une variable dichotomique <span
class="math inline">\(0-1.\)</span></p>
</div>
<div id="solution-exercice-2.8" class="section level2">
<h2>Solution exercice 2.8</h2>
<ol style="list-style-type: decimal">
<li><p>Soit <span class="math inline">\(y\)</span> une variable
dichotomique, <span class="math inline">\(y_k=1\)</span> si <span
class="math inline">\(k\)</span> a une certaine propriété et zéro sinon.
En utilisant la solution de l’exercice 2.7, on obtient que <span
class="math inline">\(P=\sum_{k\in U}y_k/N=\bar{y}_U\)</span> et donc,
l’estimateur de Horvitz-Thompson de <span
class="math inline">\(P\)</span> est égal à: <span
class="math display">\[
\hat{P}=\frac{1}{N}\sum_{k\in s}\frac{y_k}{\pi_k}=\frac{1}{n}\sum_{k\in
s}y_k=\bar{y}_s\quad \mbox{la proportion d&#39;individus dans}\quad s
\]</span> car <span class="math inline">\(\pi_k=n/N\)</span> pour tout
<span class="math inline">\(k\in U\)</span> dans le cas d’un plan
SI.</p></li>
<li><p>La proportion est un cas particulier d’une moyenne (de la
variable <span class="math inline">\(y\)</span> dichotomique), la
variance de <span class="math inline">\(\hat P\)</span> est donc: <span
class="math display">\[
\mathop{\mathrm{V}}_{\rm{SI}}(\hat{P})=\frac{1-f}{n}S^2_{yU}=\frac{1-f}{n}\frac{NP(1-P)}{N-1}=\frac{1-f}{f(N-1)}P(1-P),
\]</span> en utilisant aussi l’exercice 2.7.\</p></li>
<li><p>L’estimateur de la variance est égal à: <span
class="math display">\[
\hat{\mathop{\mathrm{V}}}_{\rm{SI}}(\hat{P})=\frac{1-f}{n}S^2_{ys}=\frac{1-f}{n}\frac{n}{n-1}\hat{P}(1-\hat{P})=\frac{1-f}{n-1}\hat{P}(1-\hat{P}),
\]</span> car <span class="math display">\[\begin{eqnarray*}
S^2_{ys}=\frac{1}{n-1}\sum_{k\in
s}(y_k-\bar{y}_s)^2=\frac{1}{n-1}\left(\sum_{k\in
s}y_k^2-n\bar{y}^2_s\right)&amp;=&amp;\frac{1}{n-1}\left(n\hat{P}-n\hat{P}^2\right)\\
&amp;=&amp; \frac{n}{n-1}\hat{P}(1-\hat{P}).
\end{eqnarray*}\]</span></p></li>
</ol>
</div>
<div id="solution-exercice-2.9" class="section level2">
<h2>Solution exercice 2.9</h2>
<ol style="list-style-type: decimal">
<li><p>On sélectionne un échantillon selon un plan aléatoire simple sans
remise de taille <span class="math inline">\(n\)</span> parmi <span
class="math inline">\(N\)</span> individus, la taille <span
class="math inline">\(n_d\)</span> de la partie <span
class="math inline">\(s_d\)</span> suit une loi hyper-géométrique de
paramètres <span class="math inline">\(N, N_d\)</span> et <span
class="math inline">\(n:\)</span> <span class="math display">\[
\mathbb{P}(n_d=n_0)=\frac{\binom{N_d}{n_0}\binom{N-N_d}{n-n_0}}{\binom{N}{n}},
\]</span> où <span class="math inline">\(n_0\in \{0,\ldots, \min(n,
N_0)\}.\)</span></p></li>
<li><p>Soit <span class="math inline">\(n_0\in \{0,\ldots, \min(n,
N_0)\},\)</span> alors <span class="math display">\[
p(s|n_d=n_0)=\frac{\mathbb{P}(s\quad \&amp;\quad
n_d=n_0)}{\mathbb{P}(n_d=n_0)}=\frac{\frac{\binom{N-N_d}{n-n_0}}{\binom{N}{n}}}{\frac{\binom{N_d}{n_0}\binom{N-N_d}{n-n_0}}{\binom{N}{n}}}=\frac{1}{\binom{N_d}{n_0}},
\]</span> ce qui correspond à plan aléatoire simple sans remise de
taille <span class="math inline">\(n_0\)</span> dans le domaine <span
class="math inline">\(U_d\)</span> de taille <span
class="math inline">\(N_d.\)</span></p></li>
</ol>
</div>
<div id="solution-exercice-2.10" class="section level2">
<h2>Solution exercice 2.10</h2>
<p>Cet exercice est basé sur l’exercice 1.9 du chapitre 1 qui traite
l’estimation du total de <span class="math inline">\(y\)</span> dans un
domaine pour un plan de sondage quelconque.</p>
<ol style="list-style-type: decimal">
<li><p>Voir la solution de l’exercice 1.9.</p></li>
<li><p>Les probabilités d’inclusion sont égales à <span
class="math inline">\(\pi_k=n/N\)</span> pour tout <span
class="math inline">\(k\in U,\)</span> donc <span
class="math display">\[
\hat{t}_{y_{d}}=\sum_{k\in s}\frac{y_k\mathbf{1}_{\{k\in
U_d\}}}{\pi_k}=\frac{N}{n}\sum_{k\in U}y_k\mathbf{1}_{\{k\in
U_d\}}=\frac{N}{n}\sum_{k\in U_d}y_k.
\]</span></p></li>
<li><p>La variance de <span class="math inline">\(\hat
t_{y_{d}}\)</span> est égale à <span
class="math display">\[\begin{eqnarray*}
\mathop{\mathrm{V}}_{\rm{SI}}(\hat{t}_{y_d})=N^2\frac{1-f}{n}S^2_{y_dU},
\end{eqnarray*}\]</span> où <span
class="math inline">\(S^2_{y_dU}\)</span> est la variance (corrigée) de
la variable <span class="math inline">\(y_d\)</span> calculée au sein de
la population <span class="math inline">\(U:\)</span> <span
class="math display">\[\begin{eqnarray*}
S^2_{y_dU}=\frac{1}{N-1}\sum_{k\in
U}(y_{kd}-\bar{y}_{dU})^2&amp;=&amp;\frac{1}{N-1}\left(\sum_{k\in
U}y^2_{kd}-N\bar{y}^2_{dU}\right)\\
&amp;=&amp;\frac{1}{N-1}\left[\sum_{k\in
U_d}y^2_{k}-\frac{1}{N}\left(\sum_{k\in U_d}y_k\right)^2\right]
\end{eqnarray*}\]</span> car <span class="math display">\[
\bar{y}_{dU}=\sum_{k\in U}y_{kd}/N=\sum_{k\in U}y_{k}\mathbf{1}_{\{k\in
U_d\}}/N=\sum_{k\in U_d}y_{k}/N.
\]</span></p></li>
<li><p>Un estimateur sans biais de <span
class="math inline">\(\mathop{\mathrm{V}}_{\rm{SI}}(\hat{t}_{y_d})\)</span>
est donné par: <span class="math display">\[\begin{eqnarray*}
\hat{\mathop{\mathrm{V}}}_{\rm{SI}}(\hat{t}_{y_d})=N^2\frac{1-f}{n}S^2_{y_d},   
\end{eqnarray*}\]</span> où <span
class="math inline">\(S^2_{y_ds}\)</span> est la variance (corrigée) de
la variable <span class="math inline">\(y_d\)</span> calculée au sein de
l’échantillon <span class="math inline">\(s:\)</span> <span
class="math display">\[\begin{eqnarray*}
S^2_{y_ds}=\frac{1}{n-1}\sum_{k\in
s}(y_{kd}-\bar{y}_{ds})^2&amp;=&amp;\frac{1}{n-1}\left(\sum_{k\in
s}y^2_{kd}-n\bar{y}^2_{ds}\right)\\
&amp;=&amp;\frac{1}{n-1}\left[\sum_{k\in
s_d}y^2_{k}-\frac{1}{n}\left(\sum_{k\in s_d}y_k\right)^2\right]
\end{eqnarray*}\]</span> car <span class="math display">\[
\bar{y}_{ds}=\sum_{k\in s}y_{kd}/n=\sum_{k\in s}y_{k}\mathbf{1}_{\{k\in
U_d\}}/n=\sum_{k\in s_d}y_{k}/n.
\]</span></p></li>
</ol>
</div>
<div id="solution-exercice-2.11" class="section level2">
<h2>Solution exercice 2.11</h2>
<p>Pour un estimateur <span class="math inline">\(\hat{\theta}\)</span>
de <span class="math inline">\(\theta,\)</span> on souhaite trouver la
taille <span class="math inline">\(n\)</span> de l’échantillon telle que
la demi-longueur de l’intervalle de confiance (asymptotique) de <span
class="math inline">\(\theta\)</span> soit au plus égale à <span
class="math inline">\(e\)</span>:<br />
<span class="math display">\[\begin{eqnarray*}
  z_{1-\alpha/2}\sqrt{\mathop{\mathrm{V}}(\hat{\theta})} \leq e,
\end{eqnarray*}\]</span> où <span
class="math inline">\(\mathop{\mathrm{V}}(\hat{\theta})\)</span> est la
variance de <span class="math inline">\(\hat{\theta}\)</span> calculée
sous le plan de sondage SI dans notre cas.</p>
<ol style="list-style-type: decimal">
<li><p>Soit <span class="math inline">\(\theta=t_{yU}\)</span> le total
d’une variable <span class="math inline">\(y\)</span> sur la population
<span class="math inline">\(U\)</span>. Alors, <span
class="math display">\[
\mathop{\mathrm{V}}_{\rm{SI}}(\hat{t}_{y\rm{HT}})=N^2\left(\frac{1}{n}-\frac{1}{N}\right)S^2_{yU}.
\]</span> On doit trouver <span class="math inline">\(n\)</span> qui
vérifie: <span class="math display">\[\begin{eqnarray*}
  z^2_{1-\alpha/2}  N^2\left(\frac{1}{n}-\frac{1}{N}\right)S^2_{yU}\leq
e^2\Longleftrightarrow n\geq
\frac{z^2_{1-\alpha/2}N^2S^2_{yU}}{e^2+z^2_{1-\alpha/2}NS^2_{yU}}\Longleftrightarrow
n\geq \frac{n_0}{1+n_0/N},
\end{eqnarray*}\]</span> où <span
class="math inline">\(n_0=N^2z^2_{1-\alpha/2}S^2_{yU}/e^2.\)</span></p></li>
<li><p>Soit <span class="math inline">\(\theta=\bar{y}_U\)</span> la
moyenne d’une variable <span class="math inline">\(y\)</span> sur la
population <span class="math inline">\(U\)</span>. Alors, <span
class="math display">\[
\mathop{\mathrm{V}}_{\rm{SI}}(\hat{\bar{y}}_{\rm{HT}})=\left(\frac{1}{n}-\frac{1}{N}\right)S^2_{yU}.
\]</span> On doit trouver <span class="math inline">\(n\)</span> qui
vérifie: <span class="math display">\[\begin{eqnarray*}
  z^2_{1-\alpha/2}  \left(\frac{1}{n}-\frac{1}{N}\right)S^2_{yU}\leq
e^2\Longleftrightarrow n\geq
\frac{z^2_{1-\alpha/2}S^2_{yU}}{e^2+z^2_{1-\alpha/2}NS^2_{yU}/N}\Longleftrightarrow
n\geq \frac{n_0}{1+n_0/N},
\end{eqnarray*}\]</span> où <span
class="math inline">\(n_0=z^2_{1-\alpha/2}S^2_{yU}/e^2.\)</span></p></li>
<li><p>Soit <span class="math inline">\(\theta=P\)</span> la proportion
d’individus ayant une certaine propriété. La variance de <span
class="math inline">\(\hat P\)</span> sous un plan SI est donnée par
<span class="math display">\[
\mathop{\mathrm{V}}_{\rm{SI}}(\hat
P)=\frac{1-f}{n}\frac{NP(1-P)}{N-1}=\left(\frac{1}{n}-\frac{1}{N}\right)\frac{NP(1-P)}{N-1}.
\]</span> On doit trouver <span class="math inline">\(n\)</span> qui
vérifie: <span class="math display">\[\begin{eqnarray*}
  z^2_{1-\alpha/2}\left(\frac{1}{n}-\frac{1}{N}\right)\frac{NP(1-P)}{N-1}\leq
e^2\Longleftrightarrow n\geq
\frac{z^2_{1-\alpha/2}\frac{NP(1-P)}{N-1}}{e^2+z^2_{1-\alpha/2}\frac{P(1-P)}{N-1}}=\frac{n_0}{1+n_0/N},
\end{eqnarray*}\]</span> pour <span
class="math inline">\(n_0=NP(1-P)/[(N-1)e^2].\)</span></p></li>
</ol>
</div>
<div id="solution-exercice-2.12" class="section level2">
<h2>Solution exercice 2.12</h2>
<p>Dans le cas d’un plan de sondage de Bernoulli, la sélection des
individus se fait de façon indépendante, donc <span
class="math inline">\(\pi_{kl}=\pi_k\pi_l\)</span> pour <span
class="math inline">\(k\neq l\in U.\)</span> La variance de l’estimateur
de Horvitz-Thompson est égale à: <span class="math display">\[
\mathop{\mathrm{V}}_{\rm{BE}}(\hat{t}_{y\rm{HT}})=\sum_{k\in
U}\pi_k(1-\pi_k)\left(\frac{y_k}{\pi_k}\right)^2+\sum_{k\in
U}\sum_{l\neq k\in
U}(\pi_{kl}-\pi_k\pi_l)\frac{y_k}{\pi_k}\frac{y_l}{\pi_l}=\frac{1-\pi}{\pi}\sum_{k\in
U}y_k^2,
\]</span> car <span class="math inline">\(\pi_k=\pi\)</span> pour tout
<span class="math inline">\(k\in U.\)</span> La variance de l’estimateur
de Horvitz-Thompson est le total sur <span
class="math inline">\(U\)</span> de la variable <span
class="math inline">\(y^2,\)</span> elle est estimée par <span
class="math display">\[
\hat{\mathop{\mathrm{V}}}_{\rm{BE}}(\hat{t}_{y\rm{HT}})=\frac{1-\pi}{\pi^2}\sum_{k\in
s}y_k^2.
\]</span> On pouvait obtenir le même estimateur de la variance en
utilisant la formule générale de l’estimateur de la variance de
l’estimateur de Horvitz-Thompson.</p>
</div>
<div id="solution-exercice-2.13" class="section level2">
<h2>Solution exercice 2.13</h2>
<ol style="list-style-type: decimal">
<li><p>La proportion <span class="math inline">\(P\)</span> s’écrit
comme une moyenne sur <span class="math inline">\(U:\)</span> <span
class="math display">\[
P=\frac{1}{N}\sum_{k\in U}y_k,
\]</span> où <span class="math inline">\(y_k=1\)</span> si l’individu
<span class="math inline">\(k\)</span> a la propriété <span
class="math inline">\(A\)</span> et zéro sinon.</p></li>
<li><p>Les probabilités d’inclusion d’ordre un sont données par <span
class="math inline">\(\pi_k=\pi=n/N\)</span> pour tout <span
class="math inline">\(k\in U\)</span> et <span class="math display">\[
\hat P=\frac{1}{N}\sum_{k\in s}\frac{y_k}{\pi}=\frac{1}{n}\sum_{k\in
s}y_k=\frac{n_s}{n}p_s,
\]</span> où <span class="math inline">\(p_s\)</span> est la proportion
d’individus ayant la propriété <span class="math inline">\(A\)</span>
dans l’échantillon de Bernoulli.</p></li>
<li><p>La variance de <span class="math inline">\(\hat P\)</span> sous
le plan BE(n/N) est égale à <span class="math display">\[
\mathop{\mathrm{V}}_{\rm{BE}}(\hat
P)=\frac{1}{N^2}\frac{1-\pi}{\pi}\sum_{k\in U}y_k^2=\frac{1-n/N}{n}P
\]</span> et elle est estimée par <span class="math display">\[
\hat{\mathop{\mathrm{V}}}_{\rm{BE}}(\hat
P)=\frac{1}{N^2}\frac{1-\pi}{\pi^2}\sum_{k\in
s}y_k^2=\frac{n_s}{n^2}\left(1-\frac{n}{N}\right)p_s.
\]</span></p></li>
</ol>
</div>
<div id="solution-exercice-2.14" class="section level2">
<h2>Solution exercice 2.14</h2>
<p>Pour ce plan de sondage <span
class="math inline">\(\pi_k=1/a\)</span> pour tout <span
class="math inline">\(k\in U\)</span> et <span
class="math inline">\(\pi_{kl}=1/a\)</span> si <span
class="math inline">\(k, l\in s_r\)</span> et zéro sinon. La variance de
l’estimateur de Horvitz-Thompson est égale à: <span
class="math display">\[\begin{eqnarray*}
\mathop{\mathrm{V}}_{\rm{SY}}(\hat{t}_{y\rm{HT}})&amp;=&amp;\sum_{k\in
U}\pi_k(1-\pi_k)\left(\frac{y_k}{\pi_k}\right)^2+\sum_{k\in U}\sum_{l\in
U, l\neq k}\Delta_{kl} \frac{y_k}{\pi_k}\frac{y_l}{\pi_l} \\
&amp;=&amp; (a-1)\sum_{k\in U}y_k^2+a^2\sum_{k\in U}\sum_{l\in U, l\neq
k}\left(\pi_{kl}-\frac{1}{a^2}\right)y_ky_l\\
&amp;=&amp; (a-1)\sum_{k\in U}y_k^2-\sum_{k\in U}\sum_{l\in U, l\neq
k}y_ky_l+a^2\sum_{k\in U}\sum_{l\in U, l\neq k}\pi_{kl}y_ky_l\\
&amp;=&amp; a\sum_{k\in U}y_k^2-(\sum_{k\in
U}y_k)^2+a^2\sum_{r=1}^a\sum_{r&#39;=1}^a\sum_{k\in s_r}\sum_{l\neq k\in
s_{r&#39;}}\pi_{kl}y_ky_l\\
&amp;=&amp; a\sum_{k\in U}y_k^2- t^2_{yU}+a\sum_{r=1}^a\sum_{k\in
s_r}\sum_{l\neq k\in s_{r}}y_ky_l\\
&amp;=&amp; a\left[\sum_{k\in U}y_k^2+\sum_{r=1}^a\sum_{k\in
s_r}\left(\sum_{l\in s_r}y_ky_l-y_k^2\right)\right]- t^2_{yU}\\
&amp;=&amp; a \sum_{r=1}^a\sum_{k\in s_r}\sum_{l\in s_r}y_ky_l-
t^2_{yU}=
a\left(\sum_{r=1}^at^2_{s_r}-a\bar{t}^2\right)=a\sum_{r=1}^a(t_{s_r}-\bar{t})^2.
\end{eqnarray*}\]</span> Dans le cas <span
class="math inline">\(N=n\times a,\)</span> on a <span
class="math inline">\(t_{s_r}=\sum_{k\in s_r}y_k=n\bar{y}_{s_r}\)</span>
pour tout <span class="math inline">\(r=1, \ldots, a\)</span> et <span
class="math inline">\(\bar t=\sum_{r=1}^a\sum_{k\in
s_r}y_k/a=n\bar{y}_U.\)</span> La variance de l’estimateur de
Horvitz-Thompson devient: <span class="math display">\[\begin{eqnarray*}
\mathop{\mathrm{V}}_{\rm{SY}}(\hat{t}_{y\rm{HT}})=
a\sum_{r=1}^a(n\bar{y}_{s_r}-n\bar{y}_U)^2=\frac{N^2}{a}
\sum_{r=1}^a(\bar{y}_{s_r}-\bar{y}_U)^2.
\end{eqnarray*}\]</span></p>
</div>
<div id="solution-exercice-2.15" class="section level2">
<h2>Solution exercice 2.15</h2>
<p>On rappelle la décomposition de la variance totale de <span
class="math inline">\(y\)</span> (c’est-à-dire au sein de la population
<span class="math inline">\(U\)</span>) par rapport aux échantillons
systématiques <span class="math inline">\(s_r, r=1, \ldots, a:\)</span>
<span class="math display">\[
\underbrace{\sum_{k\in
U}(y_k-\bar{y}_U)^2}_{\mbox{SST}}=\underbrace{\sum_{r=1}^a\sum_{k\in
s_r}(y_k-\bar{y}_{s_r})^2}_{\mbox{SSW}}+\underbrace{\sum_{r=1}^an(\bar{y}_{s_r}-\bar{y}_U)^2}_{\mbox{SSB}}.
\]</span> La variance de l’estimateur de Horvitz-Thompson avec un plan
SI est égale à <span class="math display">\[
\mathop{\mathrm{V}}_{\rm{SI}}(\hat
t_{y\rm{HT}})=N^2\frac{1-f}{n}S^2_{yU}=N^2\frac{1-f}{n}\mbox{SST}
\]</span> et sous un plan systématique avec <span
class="math inline">\(N=n\times a\)</span>: <span
class="math display">\[
\mathop{\mathrm{V}}_{\rm{SY}}(\hat t_{y\rm{HT}})=N\times \mbox{SSB}.
\]</span> L’effet plan est donné alors par <span
class="math display">\[\begin{eqnarray*}
\mbox{deff}(SY)&amp;=&amp;\frac{N\times
\mbox{SSB}}{N^2\frac{1-f}{n}\frac{\mbox{SST}}{N-1}}=\frac{\mbox{SST}-\mbox{SSW}}{\frac{1-f}{f}\frac{\mbox{SST}}{N-1}}=\frac{f(N-1)}{1-f}-\frac{\mbox{SSW}}{\mbox{SST}}\frac{(N-1)f}{1-f}
\\
&amp;=&amp;
\frac{f(N-1)}{1-f}-\frac{(N-a)f}{1-f}(1-\delta)=1+\frac{n-1}{1-f}\delta
\end{eqnarray*}\]</span> car <span
class="math inline">\(a=N/n=1/f.\)</span></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
